# BMS_predict_by_CNN
# 畳み込みニューラルネットワークを用いた黒毛和種枝肉断面画像のBMS判定

スクリプトはすべてPython3で記述しています。

Keras (TensorFlow), numpy, pandas, matplotlib, sklearn, PIL 等のパッケージを利用します。

Anaconda3 をインストールすれば、Keras (TensorFlow) 以外はデフォルトでインストールされると思います。


## 枝肉断面画像からのロース芯画像の切り出し

枝肉断面画像のロース芯中央座標を予測し、ロース芯を中心とした正方形の画像を切り出す。

Pythonスクリプトを任意のフォルダに置き、直下のフォルダに枝肉断面画像をまとめて入れておきます。

### データセットの作成

　ロース芯中央座標が明らかな画像リストのcsvファイルを作成してください。

　3カラムで、1行目のカラム名をimgpath, x, yとし、それぞれに「枝肉断面画像のパス」，「X座標の数値」，「Y座標の数値」を入力したcsvファイルにしてください。

　loincenter_makedata_for_train.py の中身を適宜変更し、実行する。

　学習用の画像データセットファイルと、座標データセットファイル（.npy）が作成されます。

### ロース芯中心座標の学習

　loincenter_train.py の中身を適宜変更し、実行する。

　学習用の画像データセットと、座標データセットのパス、および試験名を指定してください。

　
